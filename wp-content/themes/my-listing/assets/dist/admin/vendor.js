!function(t){"function"==typeof define&&define.amd?define("vendor",t):t()}(function(){"use strict";function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var e,n,i,T;e=window,n=function(r){var o,a,s,l,u,p,f,c;function t(t){this.$inputor=t}function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}function n(t){this.$inputor=t,this.domInputor=this.$inputor[0]}n.prototype.setPos=function(t){var l,u,c,h;return(h=f.getSelection())&&(c=0,u=!1,(l=function(t,e){var n,i,o,r,a,s;for(s=[],o=0,r=(a=e.childNodes).length;o<r&&(n=a[o],!u);o++)if(3===n.nodeType){if(c+n.length>=t){u=!0,(i=p.createRange()).setStart(n,t-c),h.removeAllRanges(),h.addRange(i);break}s.push(c+=n.length)}else s.push(l(t,n));return s})(t,this.domInputor)),this.domInputor},n.prototype.getIEPosition=function(){return this.getPosition()},n.prototype.getPosition=function(){var t,e;return e=this.getOffset(),t=this.$inputor.offset(),e.left-=t.left,e.top-=t.top,e},n.prototype.getOldIEPos=function(){var t,e;return e=p.selection.createRange(),(t=p.body.createTextRange()).moveToElementText(this.domInputor),t.setEndPoint("EndToEnd",e),t.text.length},n.prototype.getPos=function(){var t,e,n;return(n=this.range())?((t=n.cloneRange()).selectNodeContents(this.domInputor),t.setEnd(n.endContainer,n.endOffset),e=t.toString().length,t.detach(),e):p.selection?this.getOldIEPos():void 0},n.prototype.getOldIEOffset=function(){var t,e;return(t=p.selection.createRange().duplicate()).moveStart("character",-1),{height:(e=t.getBoundingClientRect()).bottom-e.top,left:e.left,top:e.top}},n.prototype.getOffset=function(){var t,e,n,i,o;return f.getSelection&&(n=this.range())?(0<n.endOffset-1&&n.endContainer!==this.domInputor&&((t=n.cloneRange()).setStart(n.endContainer,n.endOffset-1),t.setEnd(n.endContainer,n.endOffset),e={height:(i=t.getBoundingClientRect()).height,left:i.left+i.width,top:i.top},t.detach()),e&&0!==(null!=e?e.height:void 0)||(t=n.cloneRange(),o=r(p.createTextNode("|")),t.insertNode(o[0]),t.selectNode(o[0]),e={height:(i=t.getBoundingClientRect()).height,left:i.left,top:i.top},o.remove(),t.detach())):p.selection&&(e=this.getOldIEOffset()),e&&(e.top+=r(f).scrollTop(),e.left+=r(f).scrollLeft()),e},n.prototype.range=function(){var t;if(f.getSelection)return 0<(t=f.getSelection()).rangeCount?t.getRangeAt(0):null},o=n,e.prototype.getIEPos=function(){var t,e,n,i,o,r;return e=this.domInputor,i=0,(o=p.selection.createRange())&&o.parentElement()===e&&(n=e.value.replace(/\r\n/g,"\n").length,(r=e.createTextRange()).moveToBookmark(o.getBookmark()),(t=e.createTextRange()).collapse(!1),i=-1<r.compareEndPoints("StartToEnd",t)?n:-r.moveStart("character",-n)),i},e.prototype.getPos=function(){return p.selection?this.getIEPos():this.domInputor.selectionStart},e.prototype.setPos=function(t){var e,n;return e=this.domInputor,p.selection?((n=e.createTextRange()).move("character",t),n.select()):e.setSelectionRange&&e.setSelectionRange(t,t),e},e.prototype.getIEOffset=function(t){var e;return e=this.domInputor.createTextRange(),t=t||this.getPos(),e.move("character",t),{left:e.boundingLeft,top:e.boundingTop,height:e.boundingHeight}},e.prototype.getOffset=function(t){var e,n,i;return e=this.$inputor,p.selection?((n=this.getIEOffset(t)).top+=r(f).scrollTop()+e.scrollTop(),n.left+=r(f).scrollLeft()+e.scrollLeft(),n):(n=e.offset(),i=this.getPosition(t),n={left:n.left+i.left-e.scrollLeft(),top:n.top+i.top-e.scrollTop(),height:i.height})},e.prototype.getPosition=function(t){var e,n,i,o,r;return e=this.$inputor,i=function(t){return t=t.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>"),/firefox/i.test(navigator.userAgent)&&(t=t.replace(/\s/g,"&nbsp;")),t},void 0===t&&(t=this.getPos()),r=e.val().slice(0,t),n=e.val().slice(t),o="<span style='position: relative; display: inline;'>"+i(r)+"</span>",o+="<span id='caret' style='position: relative; display: inline;'>|</span>",o+="<span style='position: relative; display: inline;'>"+i(n)+"</span>",new s(e).create(o).rect()},e.prototype.getIEPosition=function(t){var e,n;return n=this.getIEOffset(t),e=this.$inputor.offset(),{left:n.left-e.left,top:n.top-e.top,height:n.height}},a=e,t.prototype.css_attr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],t.prototype.mirrorCss=function(){var n,i=this;return n={position:"absolute",left:-9999,top:0,zIndex:-2e4},"TEXTAREA"===this.$inputor.prop("tagName")&&this.css_attr.push("width"),r.each(this.css_attr,function(t,e){return n[e]=i.$inputor.css(e)}),n},t.prototype.create=function(t){return this.$mirror=r("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(t),this.$inputor.after(this.$mirror),this},t.prototype.rect=function(){var t,e,n;return n={left:(e=(t=this.$mirror.find("#caret")).position()).left,top:e.top,height:t.height()},this.$mirror.remove(),n},s=t,l={contentEditable:function(t){return!(!t[0].contentEditable||"true"!==t[0].contentEditable)}},u={pos:function(t){return t||0===t?this.setPos(t):this.getPos()},position:function(t){return p.selection?this.getIEPosition(t):this.getPosition(t)},offset:function(t){return this.getOffset(t)}},f=p=null,c=function(t){var e;return p=(e=null!=t?t.iframe:void 0)?(f=e.contentWindow,e.contentDocument||f.document):(f=window,document)},r.fn.caret=function(t,e,n){var i;return u[t]?(r.isPlainObject(e)?(c(e),e=void 0):c(n),i=l.contentEditable(this)?new o(this):new a(this),u[t].apply(i,[e])):r.error("Method "+t+" does not exist on jQuery.caret")},r.fn.caret.EditableCaret=o,r.fn.caret.InputCaret=a,r.fn.caret.Utils=l,r.fn.caret.apis=u},"function"==typeof define&&define.amd?define(["jquery"],function(t){return e.returnExportsGlobal=n(t)}):"object"==("undefined"==typeof exports?"undefined":ot(exports))?module.exports=n(require("jquery")):n(jQuery),window,i=function(f){var i,d,r;function t(t){this.currentFlag=null,this.controllers={},this.aliasMaps={},this.$inputor=f(t),this.setupRootElement(),this.listen()}d={ESC:27,TAB:9,ENTER:13,CTRL:17,A:65,P:80,N:78,LEFT:37,UP:38,RIGHT:39,DOWN:40,BACKSPACE:8,SPACE:32},i={beforeSave:function(t){return e.arrayToDefaultHash(t)},matcher:function(t,e,n,i){var o,r,a;return t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),n&&(t="(?:^|\\s)"+t),o=decodeURI("%C3%80"),r=decodeURI("%C3%BF"),(a=new RegExp(t+"([A-Za-z"+o+"-"+r+"0-9_"+(i?" ":"")+"'.+-]*)$|"+t+"([^\\x00-\\xff]*)$","gi").exec(e))?a[2]||a[1]:null},filter:function(t,e,n){var i,o,r,a;for(i=[],o=0,a=e.length;o<a;o++)r=e[o],~new String(r[n]).toLowerCase().indexOf(t.toLowerCase())&&i.push(r);return i},remoteFilter:null,sorter:function(t,e,n){var i,o,r,a;if(!t)return e;for(i=[],o=0,a=e.length;o<a;o++)(r=e[o]).atwho_order=new String(r[n]).toLowerCase().indexOf(t.toLowerCase()),-1<r.atwho_order&&i.push(r);return i.sort(function(t,e){return t.atwho_order-e.atwho_order})},tplEval:function(t,i){var e;e=t;try{return"string"!=typeof t&&(e=t(i)),e.replace(/\$\{([^\}]*)\}/g,function(t,e,n){return i[e]})}catch(t){return""}},highlighter:function(t,e){var n;return e?(n=new RegExp(">\\s*([^<]*?)("+e.replace("+","\\+")+")([^<]*)\\s*<","ig"),t.replace(n,function(t,e,n,i){return"> "+e+"<strong>"+n+"</strong>"+i+" <"})):t},beforeInsert:function(t,e,n){return t},beforeReposition:function(t){return t},afterMatchFailed:function(t,e){}},t.prototype.createContainer=function(t){var e;return null!=(e=this.$el)&&e.remove(),f(t.body).append(this.$el=f("<div class='atwho-container'></div>"))},t.prototype.setupRootElement=function(t,e){var n;if(null==e&&(e=!1),t)this.window=t.contentWindow,this.document=t.contentDocument||this.window.document,this.iframe=t;else{this.document=this.$inputor[0].ownerDocument,this.window=this.document.defaultView||this.document.parentWindow;try{this.iframe=this.window.frameElement}catch(t){if(n=t,this.iframe=null,f.fn.atwho.debug)throw new Error("iframe auto-discovery is failed.\nPlease use `setIframe` to set the target iframe manually.\n"+n)}}return this.createContainer((this.iframeAsRoot=e)?this.document:document)},t.prototype.controller=function(t){var e,n,i,o;if(this.aliasMaps[t])n=this.controllers[this.aliasMaps[t]];else for(i in o=this.controllers)if(e=o[i],i===t){n=e;break}return n||this.controllers[this.currentFlag]},t.prototype.setContextFor=function(t){return this.currentFlag=t,this},t.prototype.reg=function(t,e){var n,i;return i=(n=this.controllers)[t]||(n[t]=this.$inputor.is("[contentEditable]")?new c(this,t):new a(this,t)),e.alias&&(this.aliasMaps[e.alias]=t),i.init(e),this},t.prototype.listen=function(){return this.$inputor.on("compositionstart",(s=this,function(t){var e;return null!=(e=s.controller())&&e.view.hide(),s.isComposing=!0,null})).on("compositionend",(a=this,function(t){return a.isComposing=!1,setTimeout(function(t){return a.dispatch(t)}),null})).on("keyup.atwhoInner",(r=this,function(t){return r.onKeyup(t)})).on("keydown.atwhoInner",(i=this,function(t){return i.onKeydown(t)})).on("blur.atwhoInner",(n=this,function(t){var e;return(e=n.controller())?(e.expectedQueryCBId=null,e.view.hide(t,e.getOpt("displayTimeout"))):void 0})).on("click.atwhoInner",(e=this,function(t){return e.dispatch(t)})).on("scroll.atwhoInner",(o=this,function(){var i;return i=o.$inputor.scrollTop(),function(t){var e,n;return e=t.target.scrollTop,i!==e&&null!=(n=o.controller())&&n.view.hide(t),i=e,!0}}()));var o,e,n,i,r,a,s},t.prototype.shutdown=function(){var t,e;for(t in e=this.controllers)e[t].destroy(),delete this.controllers[t];return this.$inputor.off(".atwhoInner"),this.$el.remove()},t.prototype.dispatch=function(t){var e,n,i,o;for(e in o=[],i=this.controllers)n=i[e],o.push(n.lookUp(t));return o},t.prototype.onKeyup=function(t){var e;switch(t.keyCode){case d.ESC:t.preventDefault(),null!=(e=this.controller())&&e.view.hide();break;case d.DOWN:case d.UP:case d.CTRL:case d.ENTER:f.noop();break;case d.P:case d.N:t.ctrlKey||this.dispatch(t);break;default:this.dispatch(t)}},t.prototype.onKeydown=function(t){var e,n;if((n=null!=(e=this.controller())?e.view:void 0)&&n.visible())switch(t.keyCode){case d.ESC:t.preventDefault(),n.hide(t);break;case d.UP:t.preventDefault(),n.prev();break;case d.DOWN:t.preventDefault(),n.next();break;case d.P:if(!t.ctrlKey)return;t.preventDefault(),n.prev();break;case d.N:if(!t.ctrlKey)return;t.preventDefault(),n.next();break;case d.TAB:case d.ENTER:case d.SPACE:if(!n.visible())return;if(!this.controller().getOpt("spaceSelectsMatch")&&t.keyCode===d.SPACE)return;if(!this.controller().getOpt("tabSelectsMatch")&&t.keyCode===d.TAB)return;n.highlighted()?(t.preventDefault(),n.choose(t)):n.hide(t);break;default:f.noop()}},r=t;var e,o=[].slice;function n(t,e){this.app=t,this.at=e,this.$inputor=this.app.$inputor,this.id=this.$inputor[0].id||this.uid(),this.expectedQueryCBId=null,this.setting=null,this.query=null,this.pos=0,this.range=null,0===(this.$el=f("#atwho-ground-"+this.id,this.app.$el)).length&&this.app.$el.append(this.$el=f("<div id='atwho-ground-"+this.id+"'></div>")),this.model=new h(this),this.view=new p(this)}n.prototype.uid=function(){return(Math.random().toString(16)+"000000000").substr(2,8)+(new Date).getTime()},n.prototype.init=function(t){return this.setting=f.extend({},this.setting||f.fn.atwho.default,t),this.view.init(),this.model.reload(this.setting.data)},n.prototype.destroy=function(){return this.trigger("beforeDestroy"),this.model.destroy(),this.view.destroy(),this.$el.remove()},n.prototype.callDefault=function(){var t,e,n;n=arguments[0],t=2<=arguments.length?o.call(arguments,1):[];try{return i[n].apply(this,t)}catch(t){return e=t,f.error(e+" Or maybe At.js doesn't have function "+n)}},n.prototype.trigger=function(t,e){var n,i;return null==e&&(e=[]),e.push(this),i=(n=this.getOpt("alias"))?t+"-"+n+".atwho":t+".atwho",this.$inputor.trigger(i,e)},n.prototype.callbacks=function(t){return this.getOpt("callbacks")[t]||i[t]},n.prototype.getOpt=function(t,e){try{return this.setting[t]}catch(t){return null}},n.prototype.insertContentFor=function(t){var e,n;return n=this.getOpt("insertTpl"),e=f.extend({},t.data("item-data"),{"atwho-at":this.at}),this.callbacks("tplEval").call(this,n,e,"onInsert")},n.prototype.renderView=function(t){var e;return e=this.getOpt("searchKey"),t=this.callbacks("sorter").call(this,this.query.text,t.slice(0,1001),e),this.view.render(t.slice(0,this.getOpt("limit")))},n.arrayToDefaultHash=function(t){var e,n,i,o;if(!f.isArray(t))return t;for(o=[],e=0,i=t.length;e<i;e++)n=t[e],f.isPlainObject(n)?o.push(n):o.push({name:n});return o},n.prototype.lookUp=function(t){var e,n;if((!t||"click"!==t.type||this.getOpt("lookUpOnClick"))&&(!this.getOpt("suspendOnComposing")||!this.app.isComposing))return(e=this.catchQuery(t))?(this.app.setContextFor(this.at),(n=this.getOpt("delay"))?this._delayLookUp(e,n):this._lookUp(e)):this.expectedQueryCBId=null,e},n.prototype._delayLookUp=function(t,e){var n,i,o;return n=Date.now?Date.now():(new Date).getTime(),this.previousCallTime||(this.previousCallTime=n),0<(i=e-(n-this.previousCallTime))&&i<e?(this.previousCallTime=n,this._stopDelayedCall(),this.delayedCallTimeout=setTimeout((o=this,function(){return o.previousCallTime=0,o.delayedCallTimeout=null,o._lookUp(t)}),e)):(this._stopDelayedCall(),this.previousCallTime!==n&&(this.previousCallTime=0),this._lookUp(t))},n.prototype._stopDelayedCall=function(){return this.delayedCallTimeout?(clearTimeout(this.delayedCallTimeout),this.delayedCallTimeout=null):void 0},n.prototype._generateQueryCBId=function(){return{}},n.prototype._lookUp=function(t){var e;return e=function(t,e){return t===this.expectedQueryCBId?e&&0<e.length?this.renderView(this.constructor.arrayToDefaultHash(e)):this.view.hide():void 0},this.expectedQueryCBId=this._generateQueryCBId(),this.model.query(t.text,f.proxy(e,this,this.expectedQueryCBId))};var a,s=function(t,e){function n(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l={}.hasOwnProperty;function u(){return u.__super__.constructor.apply(this,arguments)}s(u,e=n),u.prototype.catchQuery=function(){var t,e,n,i,o,r,a;return e=this.$inputor.val(),t=this.$inputor.caret("pos",{iframe:this.app.iframe}),a=e.slice(0,t),(i="string"==typeof(o=this.callbacks("matcher").call(this,this.at,a,this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar"))))&&o.length<this.getOpt("minLen",0)?void 0:(i&&o.length<=this.getOpt("maxLen",20)?(n=(r=t-o.length)+o.length,o={text:o,headPos:this.pos=r,endPos:n},this.trigger("matched",[this.at,o.text])):(o=null,this.view.hide()),this.query=o)},u.prototype.rect=function(){var t,e,n;if(t=this.$inputor.caret("offset",this.pos-1,{iframe:this.app.iframe}))return this.app.iframe&&!this.app.iframeAsRoot&&(e=f(this.app.iframe).offset(),t.left+=e.left,t.top+=e.top),n=this.app.document.selection?0:2,{left:t.left,top:t.top,bottom:t.top+t.height+n}},u.prototype.insert=function(t,e){var n,i,o,r,a;return a=""+(o=(i=(n=this.$inputor).val()).slice(0,Math.max(this.query.headPos-this.at.length,0)))+(t+=r=""===(r=this.getOpt("suffix"))?r:r||" ")+i.slice(this.query.endPos||0),n.val(a),n.caret("pos",o.length+t.length,{iframe:this.app.iframe}),n.is(":focus")||n.focus(),n.change()},a=u;var c,h,p,g;s=function(t,e){function n(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l={}.hasOwnProperty;function v(){return v.__super__.constructor.apply(this,arguments)}function m(t){this.context=t,this.at=this.context.at,this.storage=this.context.$inputor}function y(t){this.context=t,this.$el=f("<div class='atwho-view'><ul class='atwho-view-ul'></ul></div>"),this.$elUl=this.$el.children(),this.timeoutID=null,this.context.$el.append(this.$el),this.bindEvent()}s(v,e),v.prototype._getRange=function(){var t;return 0<(t=this.app.window.getSelection()).rangeCount?t.getRangeAt(0):void 0},v.prototype._setRange=function(t,e,n){return null==n&&(n=this._getRange()),n&&e?(e=f(e)[0],"after"===t?(n.setEndAfter(e),n.setStartAfter(e)):(n.setEndBefore(e),n.setStartBefore(e)),n.collapse(!1),this._clearRange(n)):void 0},v.prototype._clearRange=function(t){var e;return null==t&&(t=this._getRange()),e=this.app.window.getSelection(),null==this.ctrl_a_pressed?(e.removeAllRanges(),e.addRange(t)):void 0},v.prototype._movingEvent=function(t){var e;return"click"===t.type||(e=t.which)===d.RIGHT||e===d.LEFT||e===d.UP||e===d.DOWN},v.prototype._unwrap=function(t){var e;return(e=(t=f(t).unwrap().get(0)).nextSibling)&&e.nodeValue&&(t.nodeValue+=e.nodeValue,f(e).remove()),t},v.prototype.catchQuery=function(t){var e,n,i,o,r,a,s,l,u,c,h,p;if((p=this._getRange())&&p.collapsed){if(t.which===d.ENTER)return(n=f(p.startContainer).closest(".atwho-query")).contents().unwrap(),n.is(":empty")&&n.remove(),(n=f(".atwho-query",this.app.document)).text(n.text()).contents().last().unwrap(),void this._clearRange();if(/firefox/i.test(navigator.userAgent)){if(f(p.startContainer).is(this.$inputor))return void this._clearRange();t.which===d.BACKSPACE&&p.startContainer.nodeType===document.ELEMENT_NODE&&0<=(u=p.startOffset-1)?((i=p.cloneRange()).setStart(p.startContainer,u),f(i.cloneContents()).contents().last().is(".atwho-inserted")&&(r=f(p.startContainer).contents().get(u),this._setRange("after",f(r).contents().last()))):t.which===d.LEFT&&p.startContainer.nodeType===document.TEXT_NODE&&(e=f(p.startContainer.previousSibling)).is(".atwho-inserted")&&0===p.startOffset&&this._setRange("after",e.contents().last())}if(f(p.startContainer).closest(".atwho-inserted").addClass("atwho-query").siblings().removeClass("atwho-query"),0<(n=f(".atwho-query",this.app.document)).length&&n.is(":empty")&&0===n.text().length&&n.remove(),this._movingEvent(t)||n.removeClass("atwho-inserted"),0<n.length)switch(t.which){case d.LEFT:return this._setRange("before",n.get(0),p),void n.removeClass("atwho-query");case d.RIGHT:return this._setRange("after",n.get(0).nextSibling,p),void n.removeClass("atwho-query")}if(0<n.length&&(h=n.attr("data-atwho-at-query"))&&(n.empty().html(h).attr("data-atwho-at-query",null),this._setRange("after",n.get(0),p)),(i=p.cloneRange()).setStart(p.startContainer,0),a="string"==typeof(l=this.callbacks("matcher").call(this,this.at,i.toString(),this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar"))),0===n.length&&a&&0<=(o=p.startOffset-this.at.length-l.length)&&(p.setStart(p.startContainer,o),n=f("<span/>",this.app.document).attr(this.getOpt("editableAtwhoQueryAttrs")).addClass("atwho-query"),p.surroundContents(n.get(0)),(s=n.contents().last().get(0))&&(/firefox/i.test(navigator.userAgent)?(p.setStart(s,s.length),p.setEnd(s,s.length),this._clearRange(p)):this._setRange("after",s,p))),!(a&&l.length<this.getOpt("minLen",0)))return a&&l.length<=this.getOpt("maxLen",20)?(c={text:l,el:n},this.trigger("matched",[this.at,c.text]),this.query=c):(this.view.hide(),this.query={el:n},0<=n.text().indexOf(this.at)&&(this._movingEvent(t)&&n.hasClass("atwho-inserted")?n.removeClass("atwho-query"):!1!==this.callbacks("afterMatchFailed").call(this,this.at,n)&&this._setRange("after",this._unwrap(n.text(n.text()).contents().first()))),null)}},v.prototype.rect=function(){var t,e;return(e=this.query.el.offset())&&this.query.el[0].getClientRects().length?(this.app.iframe&&!this.app.iframeAsRoot&&(t=f(this.app.iframe).offset(),e.left+=t.left-this.$inputor.scrollLeft(),e.top+=t.top-this.$inputor.scrollTop()),e.bottom=e.top+this.query.el.height(),e):void 0},v.prototype.insert=function(t,e){var n,i,o,r,a;return this.$inputor.is(":focus")||this.$inputor.focus(),(i=this.getOpt("functionOverrides")).insert?i.insert.call(this,t,e):(r=""===(r=this.getOpt("suffix"))?r:r||" ",n=e.data("item-data"),this.query.el.removeClass("atwho-query").addClass("atwho-inserted").html(t).attr("data-atwho-at-query",""+n["atwho-at"]+this.query.text).attr("contenteditable","false"),(o=this._getRange())&&(this.query.el.length&&o.setEndAfter(this.query.el[0]),o.collapse(!1),o.insertNode(a=this.app.document.createTextNode(""+r)),this._setRange("after",a,o)),this.$inputor.is(":focus")||this.$inputor.focus(),this.$inputor.change())},c=v,m.prototype.destroy=function(){return this.storage.data(this.at,null)},m.prototype.saved=function(){return 0<this.fetch()},m.prototype.query=function(t,e){var n,i,o;return i=this.fetch(),o=this.context.getOpt("searchKey"),i=this.context.callbacks("filter").call(this.context,t,i,o)||[],n=this.context.callbacks("remoteFilter"),0<i.length||!n&&0===i.length?e(i):n.call(this.context,t,e)},m.prototype.fetch=function(){return this.storage.data(this.at)||[]},m.prototype.save=function(t){return this.storage.data(this.at,this.context.callbacks("beforeSave").call(this.context,t||[]))},m.prototype.load=function(t){return!this.saved()&&t?this._load(t):void 0},m.prototype.reload=function(t){return this._load(t)},m.prototype._load=function(t){return"string"==typeof t?f.ajax(t,{dataType:"json"}).done((e=this,function(t){return e.save(t)})):this.save(t);var e},h=m,y.prototype.init=function(){var t,e;return e=this.context.getOpt("alias")||this.context.at.charCodeAt(0),(t=this.context.getOpt("headerTpl"))&&1===this.$el.children().length&&this.$el.prepend(t),this.$el.attr({id:"at-view-"+e})},y.prototype.destroy=function(){return this.$el.remove()},y.prototype.bindEvent=function(){var n,i,o,e;return n=this.$el.find("ul"),o=i=0,n.on("mousemove.atwho-view","li",function(t){var e;if((i!==t.clientX||o!==t.clientY)&&(i=t.clientX,o=t.clientY,!(e=f(t.currentTarget)).hasClass("cur")))return n.find(".cur").removeClass("cur"),e.addClass("cur")}).on("click.atwho-view","li",(e=this,function(t){return n.find(".cur").removeClass("cur"),f(t.currentTarget).addClass("cur"),e.choose(t),t.preventDefault()}))},y.prototype.visible=function(){return f.expr.filters.visible(this.$el[0])},y.prototype.highlighted=function(){return 0<this.$el.find(".cur").length},y.prototype.choose=function(t){var e,n;return(e=this.$el.find(".cur")).length&&(n=this.context.insertContentFor(e),this.context._stopDelayedCall(),this.context.insert(this.context.callbacks("beforeInsert").call(this.context,n,e,t),e),this.context.trigger("inserted",[e,t]),this.hide(t)),this.context.getOpt("hideWithoutSuffix")?this.stopShowing=!0:void 0},y.prototype.reposition=function(t){var e,n,i,o;return e=this.context.app.iframeAsRoot?this.context.app.window:window,t.bottom+this.$el.height()-f(e).scrollTop()>f(e).height()&&(t.bottom=t.top-this.$el.height()),t.left>(i=f(e).width()-this.$el.width()-5)&&(t.left=i),n={left:t.left,top:t.bottom},null!=(o=this.context.callbacks("beforeReposition"))&&o.call(this.context,n),this.$el.offset(n),this.context.trigger("reposition",[n])},y.prototype.next=function(){var t,e,n;return(t=this.$el.find(".cur").removeClass("cur").next()).length||(t=this.$el.find("li:first")),t.addClass("cur"),n=(e=t[0]).offsetTop+e.offsetHeight+(e.nextSibling?e.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,n-this.$el.height()))},y.prototype.prev=function(){var t,e,n;return(e=this.$el.find(".cur").removeClass("cur").prev()).length||(e=this.$el.find("li:last")),e.addClass("cur"),t=(n=e[0]).offsetTop+n.offsetHeight+(n.nextSibling?n.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,t-this.$el.height()))},y.prototype.scrollTop=function(t){var e;return(e=this.context.getOpt("scrollDuration"))?this.$elUl.animate({scrollTop:t},e):this.$elUl.scrollTop(t)},y.prototype.show=function(){var t;return this.stopShowing?void(this.stopShowing=!1):(this.visible()||(this.$el.show(),this.$el.scrollTop(0),this.context.trigger("shown")),(t=this.context.rect())?this.reposition(t):void 0)},y.prototype.hide=function(t,e){var n,i;if(this.visible())return isNaN(e)?(this.$el.hide(),this.context.trigger("hidden",[t])):(n=function(){return i.hide()},clearTimeout((i=this).timeoutID),this.timeoutID=setTimeout(n,e))},y.prototype.render=function(t){var e,n,i,o,r,a,s;if(f.isArray(t)&&0<t.length){for(this.$el.find("ul").empty(),n=this.$el.find("ul"),s=this.context.getOpt("displayTpl"),i=0,r=t.length;i<r;i++)o=t[i],o=f.extend({},o,{"atwho-at":this.context.at}),a=this.context.callbacks("tplEval").call(this.context,s,o,"onDisplay"),(e=f(this.context.callbacks("highlighter").call(this.context,a,this.context.query.text))).data("item-data",o),n.append(e);return this.show(),this.context.getOpt("highlightFirst")?n.find("li:first").addClass("cur"):void 0}this.hide()},p=y,g={load:function(t,e){var n;return(n=this.controller(t))?n.model.load(e):void 0},isSelecting:function(){var t;return!!(null!=(t=this.controller())?t.view.visible():void 0)},hide:function(){var t;return null!=(t=this.controller())?t.view.hide():void 0},reposition:function(){var t;return(t=this.controller())?t.view.reposition(t.rect()):void 0},setIframe:function(t,e){return this.setupRootElement(t,e),null},run:function(){return this.dispatch()},destroy:function(){return this.shutdown(),this.$inputor.data("atwho",null)}},f.fn.atwho=function(n){var i,o;return i=arguments,o=null,this.filter('textarea, input, [contenteditable=""], [contenteditable=true]').each(function(){var t,e;return(e=(t=f(this)).data("atwho"))||t.data("atwho",e=new r(this)),"object"!=ot(n)&&n?g[n]&&e?o=g[n].apply(e,Array.prototype.slice.call(i,1)):f.error("Method "+n+" does not exist on jQuery.atwho"):e.reg(n.at,n)}),null!=o?o:this},f.fn.atwho.default={at:void 0,alias:void 0,data:null,displayTpl:"<li>${name}</li>",insertTpl:"${atwho-at}${name}",headerTpl:null,callbacks:i,functionOverrides:{},searchKey:"name",suffix:void 0,hideWithoutSuffix:!1,startWithSpace:!0,acceptSpaceBar:!1,highlightFirst:!0,limit:5,maxLen:20,minLen:0,displayTimeout:300,delay:null,spaceSelectsMatch:!1,tabSelectsMatch:!0,editableAtwhoQueryAttrs:{},scrollDuration:150,suspendOnComposing:!0,lookUpOnClick:!0},f.fn.atwho.debug=!1},"function"==typeof define&&define.amd?define(["jquery"],function(t){return i(t)}):"object"==("undefined"==typeof exports?"undefined":ot(exports))?module.exports=i(require("jquery")):i(jQuery),(T=jQuery).fn.tipTip=function(t){var w=T.extend({activation:"hover",keepAlive:!1,maxWidth:"200px",edgeOffset:3,defaultPosition:"bottom",delay:400,fadeIn:200,fadeOut:200,attribute:"title",content:!1,enter:function(){},exit:function(){}},t);if(T("#tiptip_holder").length<=0){(C=T('<div id="tiptip_holder"></div>')).css("max-width",w.maxWidth);var x=T('<div id="tiptip_content"></div>'),_=T('<div id="tiptip_arrow"></div>');T("body").append(C.html(x).prepend(_.html('<div id="tiptip_arrow_inner"></div>')))}else{var C=T("#tiptip_holder");x=T("#tiptip_content"),_=T("#tiptip_arrow")}return this.each(function(){function t(){w.enter.call(this),x.html(y),C.hide().removeAttr("class").css("margin","0"),_.removeAttr("style");var t=parseInt(m.offset().top),e=parseInt(m.offset().left),n=parseInt(m.outerWidth()),i=parseInt(m.outerHeight()),o=C.outerWidth(),r=C.outerHeight(),a=Math.round((n-o)/2),s=Math.round((i-r)/2),l=Math.round(e+a),u=Math.round(t+i+w.edgeOffset),c="",h="",p=Math.round(o-12)/2;"bottom"==w.defaultPosition?c="_bottom":"top"==w.defaultPosition?c="_top":"left"==w.defaultPosition?c="_left":"right"==w.defaultPosition&&(c="_right");var f=a+e<parseInt(T(window).scrollLeft()),d=o+e>parseInt(T(window).width());f&&a<0||"_right"==c&&!d||"_left"==c&&e<o+w.edgeOffset+5?(c="_right",h=Math.round(r-13)/2,p=-12,l=Math.round(e+n+w.edgeOffset),u=Math.round(t+s)):(d&&a<0||"_left"==c&&!f)&&(c="_left",h=Math.round(r-13)/2,p=Math.round(o),l=Math.round(e-(o+w.edgeOffset+5)),u=Math.round(t+s));var g=t+i+w.edgeOffset+r+8>parseInt(T(window).height()+T(window).scrollTop()),v=t+i-(w.edgeOffset+r+8)<0;g||"_bottom"==c&&g||"_top"==c&&!v?("_top"==c||"_bottom"==c?c="_top":c+="_top",h=r,u=Math.round(t-(r+5+w.edgeOffset))):(v|("_top"==c&&v)||"_bottom"==c&&!g)&&("_top"==c||"_bottom"==c?c="_bottom":c+="_bottom",h=-12,u=Math.round(t+i+w.edgeOffset)),"_right_top"==c||"_left_top"==c?u+=5:"_right_bottom"!=c&&"_left_bottom"!=c||(u-=5),"_left_top"!=c&&"_left_bottom"!=c||(l+=5),_.css({"margin-left":p+"px","margin-top":h+"px"}),C.css({"margin-left":l+"px","margin-top":u+"px"}).attr("class","tip"+c),b&&clearTimeout(b),b=setTimeout(function(){C.stop(!0,!0).fadeIn(w.fadeIn)},w.delay)}function e(){w.exit.call(this),b&&clearTimeout(b),C.fadeOut(w.fadeOut)}var m=T(this);if(w.content)y=w.content;else var y=m.attr(w.attribute);if(""!=y){w.content||m.removeAttr(w.attribute);var b=!1;"hover"==w.activation?(m.hover(function(){t()},function(){w.keepAlive||e()}),w.keepAlive&&C.hover(function(){},function(){e()})):"focus"==w.activation?m.focus(function(){t()}).blur(function(){e()}):"click"==w.activation&&(m.click(function(){return t(),!1}).hover(function(){},function(){w.keepAlive||e()}),w.keepAlive&&C.hover(function(){},function(){e()}))}})},function(){function t(){}function y(t){var e=ot(t);return null!=t&&("object"==e||"function"==e)}function r(t){return null!=t&&"object"==ot(t)}function n(t){var e;if(!(e="symbol"==ot(t))&&(e=r(t))){if(null==t)t=t===x?"[object Undefined]":"[object Null]";else if(v&&v in Object(t)){e=f.call(t,v);var n=t[v];try{t[v]=x;var i=!0}catch(t){}var o=d.call(t);i&&(e?t[v]=n:delete t[v]),t=o}else t=d.call(t);e="[object Symbol]"==t}return e}function b(t){if("number"==typeof t)return t;if(n(t))return i;if(y(t)&&(t=y(t="function"==typeof t.valueOf?t.valueOf():t)?t+"":t),"string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var e=s.test(t);return e||l.test(t)?u(t.slice(2),e?2:8):a.test(t)?i:+t}function w(){return c.Date.now()}var x,i=NaN,o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt,e="object"==("undefined"==typeof self?"undefined":ot(self))&&self&&self.Object===Object&&self,c="object"==("undefined"==typeof global?"undefined":ot(global))&&global&&global.Object===Object&&global||e||Function("return this")(),h=(e="object"==("undefined"==typeof exports?"undefined":ot(exports))&&exports&&!exports.nodeType&&exports)&&"object"==("undefined"==typeof module?"undefined":ot(module))&&module&&!module.nodeType&&module,p=Object.prototype,f=p.hasOwnProperty,d=p.toString,g=c._,v=(p=c.Symbol)?p.toStringTag:x,_=Math.max,C=Math.min;t.debounce=function(i,o,t){function n(t){var e=l,n=u;return l=u=x,d=t,h=i.apply(n,e)}function r(t){var e=t-f;return t-=d,f===x||o<=e||e<0||v&&c<=t}function a(){var t=w();if(r(t))return s(t);var e,n=setTimeout;e=t-d,t=o-(t-f),e=v?C(t,c-e):t,p=n(a,e)}function s(t){return p=x,m&&l?n(t):(l=u=x,h)}function e(){var t=w(),e=r(t);if(l=arguments,u=this,f=t,e){if(p===x)return d=t=f,p=setTimeout(a,o),g?n(t):h;if(v)return p=setTimeout(a,o),n(f)}return p===x&&(p=setTimeout(a,o)),h}var l,u,c,h,p,f,d=0,g=!1,v=!1,m=!0;if("function"!=typeof i)throw new TypeError("Expected a function");return o=b(o)||0,y(t)&&(g=!!t.leading,c=(v="maxWait"in t)?_(b(t.maxWait)||0,o):c,m="trailing"in t?!!t.trailing:m),e.cancel=function(){p!==x&&clearTimeout(p),d=0,l=f=u=p=x},e.flush=function(){return p===x?h:s(w())},e},t.isObject=y,t.isObjectLike=r,t.isSymbol=n,t.noConflict=function(){return c._===this&&(c._=g),this},t.now=w,t.toNumber=b,t.VERSION="4.17.4","function"==typeof define&&"object"==ot(define.amd)&&define.amd?(c._=t,define(function(){return t})):h?((h.exports=t)._=t,e._=t):c._=t}.call(window);var t,o=_.noConflict();MyListing.Helpers.debounce=o.debounce,t=function(){if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};function r(t){function e(i,o){return void 0!==i&&!0!==i||(i=n.name),"function"==typeof i?i:function(t,e){var n=e.options.group.name;return o?i:i&&(i.join?-1<i.indexOf(n):n==i)}}var n={},i=t.group;i&&"object"==ot(i)||(i={name:i}),n.name=i.name,n.checkPull=e(i.pull,!0),n.checkPut=e(i.put),n.revertClone=i.revertClone,t.group=n}var C,T,$,E,D,O,h,v,m,y,S,k,I,u,i,R,A,c,l,P,t,b={},o=/\s+/g,M=/left|right|inline/,N="Sortable"+(new Date).getTime(),w=window,p=w.document,a=w.parseInt,e=w.jQuery||w.Zepto,n=w.Polymer,s=!1,f=!!("draggable"in p.createElement("div")),d=!navigator.userAgent.match(/Trident.*rv[ :]?11\./)&&((t=p.createElement("x")).style.cssText="pointer-events:auto","auto"===t.style.pointerEvents),L=!1,x=Math.abs,g=Math.min,_=[],B=[],j=et(function(t,e,n){if(n&&e.scroll){var i,o,r,a,s,l,u=n[N],c=e.scrollSensitivity,h=e.scrollSpeed,p=t.clientX,f=t.clientY,d=window.innerWidth,g=window.innerHeight;if(m!==n&&(v=e.scroll,m=n,y=e.scrollFn,!0===v)){v=n;do{if(v.offsetWidth<v.scrollWidth||v.offsetHeight<v.scrollHeight)break}while(v=v.parentNode)}v&&(o=(i=v).getBoundingClientRect(),r=(x(o.right-p)<=c)-(x(o.left-p)<=c),a=(x(o.bottom-f)<=c)-(x(o.top-f)<=c)),r||a||(a=(g-f<=c)-(f<=c),((r=(d-p<=c)-(p<=c))||a)&&(i=w)),b.vx===r&&b.vy===a&&b.el===i||(b.el=i,b.vx=r,b.vy=a,clearInterval(b.pid),i&&(b.pid=setInterval(function(){if(l=a?a*h:0,s=r?r*h:0,"function"==typeof y)return y.call(u,s,l,t);i===w?w.scrollTo(w.pageXOffset+s,w.pageYOffset+l):(i.scrollTop+=l,i.scrollLeft+=s)},24)))}},30);function q(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=nt({},e),t[N]=this;var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0}};for(var i in n)i in e||(e[i]=n[i]);for(var o in r(e),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!e.forceFallback&&f,W(t,"mousedown",this._onTapStart),W(t,"touchstart",this._onTapStart),W(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(W(t,"dragover",this),W(t,"dragenter",this)),B.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function U(t,e){"clone"!==t.lastPullMode&&(e=!0),E&&E.state!==e&&(Y(E,"display",e?"none":""),e||E.state&&(t.options.group.revertClone?(D.insertBefore(E,O),t._animate(C,E)):D.insertBefore(E,C)),E.state=e)}function F(t,e,n){if(t){n=n||p;do{if(">*"===e&&t.parentNode===n||tt(t,e))return t}while(void 0,t=(o=(i=t).host)&&o.nodeType?o:i.parentNode)}var i,o;return null}function W(t,e,n){t.addEventListener(e,n,s)}function V(t,e,n){t.removeEventListener(e,n,s)}function X(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(o," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(o," ")}}function Y(t,e,n){var i=t&&t.style;if(i){if(void 0===n)return p.defaultView&&p.defaultView.getComputedStyle?n=p.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in i||(e="-webkit-"+e),i[e]=n+("string"==typeof n?"":"px")}}function H(t,e,n){if(t){var i=t.getElementsByTagName(e),o=0,r=i.length;if(n)for(;o<r;o++)n(i[o],o);return i}return[]}function Q(t,e,n,i,o,r,a){t=t||e[N];var s=p.createEvent("Event"),l=t.options,u="on"+n.charAt(0).toUpperCase()+n.substr(1);s.initEvent(n,!0,!0),s.to=e,s.from=o||e,s.item=i||e,s.clone=E,s.oldIndex=r,s.newIndex=a,e.dispatchEvent(s),l[u]&&l[u].call(t,s)}function K(t,e,n,i,o,r,a,s){var l,u,c=t[N],h=c.options.onMove;return(l=p.createEvent("Event")).initEvent("move",!0,!0),l.to=e,l.from=t,l.dragged=n,l.draggedRect=i,l.related=o||e,l.relatedRect=r||e.getBoundingClientRect(),l.willInsertAfter=s,t.dispatchEvent(l),h&&(u=h.call(c,l,a)),u}function z(t){t.draggable=!1}function G(){L=!1}function Z(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function J(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t&&t.previousElementSibling;)"TEMPLATE"===t.nodeName.toUpperCase()||">*"!==e&&!tt(t,e)||n++;return n}function tt(t,e){if(t){var n=(e=e.split(".")).shift().toUpperCase(),i=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");return!(""!==n&&t.nodeName.toUpperCase()!=n||e.length&&((" "+t.className+" ").match(i)||[]).length!=e.length)}return!1}function et(t,e){var n,i;return function(){void 0===n&&(n=arguments,i=this,setTimeout(function(){1===n.length?t.call(i,n[0]):t.apply(i,n),n=void 0},e))}}function nt(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function it(t){return e?e(t).clone(!0)[0]:n&&n.dom?n.dom(t).cloneNode(!0):t.cloneNode(!0)}q.prototype={constructor:q,_onTapStart:function(t){var e,n=this,i=this.el,o=this.options,r=o.preventOnFilter,a=t.type,s=t.touches&&t.touches[0],l=(s||t).target,u=t.target.shadowRoot&&t.path&&t.path[0]||l,c=o.filter;if(function(t){var e=t.getElementsByTagName("input"),n=e.length;for(;n--;){var i=e[n];i.checked&&_.push(i)}}(i),!C&&!(/mousedown|pointerdown/.test(a)&&0!==t.button||o.disabled)&&(l=F(l,o.draggable,i))&&h!==l){if(e=J(l,o.draggable),"function"==typeof c){if(c.call(this,t,l,this))return Q(n,u,"filter",l,i,e),void(r&&t.preventDefault())}else if(c=c&&c.split(",").some(function(t){if(t=F(u,t.trim(),i))return Q(n,t,"filter",l,i,e),!0}))return void(r&&t.preventDefault());o.handle&&!F(u,o.handle,i)||this._prepareDragStart(t,s,l,e)}},_prepareDragStart:function(t,e,n,i){var o,r=this,a=r.el,s=r.options,l=a.ownerDocument;n&&!C&&n.parentNode===a&&(c=t,D=a,T=(C=n).parentNode,O=C.nextSibling,h=n,R=s.group,u=i,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,C.style["will-change"]="transform",o=function(){r._disableDelayedDrag(),C.draggable=r.nativeDraggable,X(C,s.chosenClass,!0),r._triggerDragStart(t,e),Q(r,D,"choose",C,D,u)},s.ignore.split(",").forEach(function(t){H(C,t.trim(),z)}),W(l,"mouseup",r._onDrop),W(l,"touchend",r._onDrop),W(l,"touchcancel",r._onDrop),W(l,"pointercancel",r._onDrop),W(l,"selectstart",r),s.delay?(W(l,"mouseup",r._disableDelayedDrag),W(l,"touchend",r._disableDelayedDrag),W(l,"touchcancel",r._disableDelayedDrag),W(l,"mousemove",r._disableDelayedDrag),W(l,"touchmove",r._disableDelayedDrag),W(l,"pointermove",r._disableDelayedDrag),r._dragStartTimer=setTimeout(o,s.delay)):o())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),V(t,"mouseup",this._disableDelayedDrag),V(t,"touchend",this._disableDelayedDrag),V(t,"touchcancel",this._disableDelayedDrag),V(t,"mousemove",this._disableDelayedDrag),V(t,"touchmove",this._disableDelayedDrag),V(t,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(t,e){(e=e||("touch"==t.pointerType?t:null))?(c={target:C,clientX:e.clientX,clientY:e.clientY},this._onDragStart(c,"touch")):this.nativeDraggable?(W(C,"dragend",this),W(D,"dragstart",this._onDragStart)):this._onDragStart(c,!0);try{p.selection?setTimeout(function(){p.selection.empty()}):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(){if(D&&C){var t=this.options;X(C,t.ghostClass,!0),X(C,t.dragClass,!1),Q(q.active=this,D,"start",C,D,u)}else this._nulling()},_emulateDragOver:function(){if(l){if(this._lastX===l.clientX&&this._lastY===l.clientY)return;this._lastX=l.clientX,this._lastY=l.clientY,d||Y($,"display","none");var t=p.elementFromPoint(l.clientX,l.clientY),e=t,n=B.length;if(e)do{if(e[N]){for(;n--;)B[n]({clientX:l.clientX,clientY:l.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);d||Y($,"display","")}},_onTouchMove:function(t){if(c){var e=this.options,n=e.fallbackTolerance,i=e.fallbackOffset,o=t.touches?t.touches[0]:t,r=o.clientX-c.clientX+i.x,a=o.clientY-c.clientY+i.y,s=t.touches?"translate3d("+r+"px,"+a+"px,0)":"translate("+r+"px,"+a+"px)";if(!q.active){if(n&&g(x(o.clientX-this._lastX),x(o.clientY-this._lastY))<n)return;this._dragStarted()}this._appendGhost(),P=!0,l=o,Y($,"webkitTransform",s),Y($,"mozTransform",s),Y($,"msTransform",s),Y($,"transform",s),t.preventDefault()}},_appendGhost:function(){if(!$){var t,e=C.getBoundingClientRect(),n=Y(C),i=this.options;X($=C.cloneNode(!0),i.ghostClass,!1),X($,i.fallbackClass,!0),X($,i.dragClass,!0),Y($,"top",e.top-a(n.marginTop,10)),Y($,"left",e.left-a(n.marginLeft,10)),Y($,"width",e.width),Y($,"height",e.height),Y($,"opacity","0.8"),Y($,"position","fixed"),Y($,"zIndex","100000"),Y($,"pointerEvents","none"),i.fallbackOnBody&&p.body.appendChild($)||D.appendChild($),t=$.getBoundingClientRect(),Y($,"width",2*e.width-t.width),Y($,"height",2*e.height-t.height)}},_onDragStart:function(t,e){var n=t.dataTransfer,i=this.options;this._offUpEvents(),R.checkPull(this,this,C,t)&&((E=it(C)).draggable=!1,E.style["will-change"]="",Y(E,"display","none"),X(E,this.options.chosenClass,!1),D.insertBefore(E,C),Q(this,D,"clone",C)),X(C,i.dragClass,!0),e?("touch"===e?(W(p,"touchmove",this._onTouchMove),W(p,"touchend",this._onDrop),W(p,"touchcancel",this._onDrop),W(p,"pointermove",this._onTouchMove),W(p,"pointerup",this._onDrop)):(W(p,"mousemove",this._onTouchMove),W(p,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(n&&(n.effectAllowed="move",i.setData&&i.setData.call(this,n,C)),W(p,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(t){var e,n,i,o,r=this.el,a=this.options,s=a.group,l=q.active,u=R===s,c=!1,h=a.sort;if(void 0!==t.preventDefault&&(t.preventDefault(),a.dragoverBubble||t.stopPropagation()),!C.animated&&(P=!0,l&&!a.disabled&&(u?h||(o=!D.contains(C)):A===this||(l.lastPullMode=R.checkPull(this,l,C,t))&&s.checkPut(this,l,C,t))&&(void 0===t.rootEl||t.rootEl===this.el))){if(j(t,a,this.el),L)return;if(e=F(t.target,a.draggable,r),n=C.getBoundingClientRect(),A!==this&&(A=this,c=!0),o)return U(l,!0),T=D,void(E||O?D.insertBefore(C,E||O):h||D.appendChild(C));if(0===r.children.length||r.children[0]===$||r===t.target&&function(t,e){var n=t.lastElementChild.getBoundingClientRect();return 5<e.clientY-(n.top+n.height)||5<e.clientX-(n.left+n.width)}(r,t)){if(0!==r.children.length&&r.children[0]!==$&&r===t.target&&(e=r.lastElementChild),e){if(e.animated)return;i=e.getBoundingClientRect()}U(l,u),!1!==K(D,r,C,n,e,i,t)&&(C.contains(r)||(r.appendChild(C),T=r),this._animate(n,C),e&&this._animate(i,e))}else if(e&&!e.animated&&e!==C&&void 0!==e.parentNode[N]){S!==e&&(k=Y(S=e),I=Y(e.parentNode));var p=(i=e.getBoundingClientRect()).right-i.left,f=i.bottom-i.top,d=M.test(k.cssFloat+k.display)||"flex"==I.display&&0===I["flex-direction"].indexOf("row"),g=e.offsetWidth>C.offsetWidth,v=e.offsetHeight>C.offsetHeight,m=.5<(d?(t.clientX-i.left)/p:(t.clientY-i.top)/f),y=e.nextElementSibling,b=!1;if(d){var w=C.offsetTop,x=e.offsetTop;b=w===x?e.previousElementSibling===C&&!g||m&&g:e.previousElementSibling===C||C.previousElementSibling===e?.5<(t.clientY-i.top)/f:w<x}else c||(b=y!==C&&!v||m&&v);var _=K(D,r,C,n,e,i,t,b);!1!==_&&(1!==_&&-1!==_||(b=1===_),L=!0,setTimeout(G,30),U(l,u),C.contains(r)||(b&&!y?r.appendChild(C):e.parentNode.insertBefore(C,b?y:e)),T=C.parentNode,this._animate(n,C),this._animate(i,e))}}},_animate:function(t,e){var n=this.options.animation;if(n){var i=e.getBoundingClientRect();1===t.nodeType&&(t=t.getBoundingClientRect()),Y(e,"transition","none"),Y(e,"transform","translate3d("+(t.left-i.left)+"px,"+(t.top-i.top)+"px,0)"),e.offsetWidth,Y(e,"transition","all "+n+"ms"),Y(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=setTimeout(function(){Y(e,"transition",""),Y(e,"transform",""),e.animated=!1},n)}},_offUpEvents:function(){var t=this.el.ownerDocument;V(p,"touchmove",this._onTouchMove),V(p,"pointermove",this._onTouchMove),V(t,"mouseup",this._onDrop),V(t,"touchend",this._onDrop),V(t,"pointerup",this._onDrop),V(t,"touchcancel",this._onDrop),V(t,"pointercancel",this._onDrop),V(t,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;clearInterval(this._loopId),clearInterval(b.pid),clearTimeout(this._dragStartTimer),V(p,"mousemove",this._onTouchMove),this.nativeDraggable&&(V(p,"drop",this),V(e,"dragstart",this._onDragStart)),this._offUpEvents(),t&&(P&&(t.preventDefault(),n.dropBubble||t.stopPropagation()),$&&$.parentNode&&$.parentNode.removeChild($),D!==T&&"clone"===q.active.lastPullMode||E&&E.parentNode&&E.parentNode.removeChild(E),C&&(this.nativeDraggable&&V(C,"dragend",this),z(C),C.style["will-change"]="",X(C,this.options.ghostClass,!1),X(C,this.options.chosenClass,!1),Q(this,D,"unchoose",C,D,u),D!==T?0<=(i=J(C,n.draggable))&&(Q(null,T,"add",C,D,u,i),Q(this,D,"remove",C,D,u,i),Q(null,T,"sort",C,D,u,i),Q(this,D,"sort",C,D,u,i)):C.nextSibling!==O&&0<=(i=J(C,n.draggable))&&(Q(this,D,"update",C,D,u,i),Q(this,D,"sort",C,D,u,i)),q.active&&(null!=i&&-1!==i||(i=u),Q(this,D,"end",C,D,u,i),this.save()))),this._nulling()},_nulling:function(){D=C=T=$=O=E=h=v=m=c=l=P=i=S=k=A=R=q.active=null,_.forEach(function(t){t.checked=!0}),_.length=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragover":case"dragenter":C&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move");t.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],n=this.el.children,i=0,o=n.length,r=this.options;i<o;i++)F(t=n[i],r.draggable,this.el)&&e.push(t.getAttribute(r.dataIdAttr)||Z(t));return e},sort:function(t){var i={},o=this.el;this.toArray().forEach(function(t,e){var n=o.children[e];F(n,this.options.draggable,o)&&(i[t]=n)},this),t.forEach(function(t){i[t]&&(o.removeChild(i[t]),o.appendChild(i[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return F(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];n[t]=e,"group"===t&&r(n)},destroy:function(){var t=this.el;t[N]=null,V(t,"mousedown",this._onTapStart),V(t,"touchstart",this._onTapStart),V(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(V(t,"dragover",this),V(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),B.splice(B.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},W(p,"touchmove",function(t){q.active&&t.preventDefault()});try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){s={capture:!1,passive:!1}}}))}catch(t){}return q.utils={on:W,off:V,css:Y,find:H,is:function(t,e){return!!F(t,e,t)},extend:nt,throttle:et,closest:F,toggleClass:X,clone:it,index:J},q.create=function(t,e){return new q(t,e)},q.version="1.6.1",q},"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&void 0!==module.exports?module.exports=t():window.Sortable=t();var m,s,l,h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};function p(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function y(t){return t}function b(t){return m.isArray(t)}function u(t){return!b(t)&&t instanceof Object}function c(t,e){return m.inArray(e,t)}function w(t,e){for(var n in t)t.hasOwnProperty(n)&&e(t[n],n,t)}function x(t){return t[t.length-1]}function C(){var n={};return w(function(t){return Array.prototype.slice.call(t)}(arguments),function(t){w(t,function(t,e){n[e]=t})}),n}function $(t,e,n){return b(t)?function(t,i){var o=[];return w(t,function(t,e,n){o.push(i(t,e,n))}),o}(t,e):function(t,i,o){var r={};return w(t,function(t,e,n){e=o?o(e,t):e,r[e]=i(t,e,n)}),r}(t,e,n)}function r(t,n,i){return $(t,function(t,e){return t[n].apply(t,i||[])})}function a(t,i){var o,r=function(t){var i={};return(t=t||{}).publish=function(t,e){w(i[t],function(t){t(e)})},t.subscribe=function(t,e){i[t]=i[t]||[],i[t].push(e)},t.unsubscribe=function(n){w(i,function(t){var e=c(t,n);-1!==e&&t.splice(e,1)})},t}(),e=t.$;return r.getType=function(){throw'implement me (return type. "text", "radio", etc.)'},r.$=function(t){return t?e.find(t):e},r.disable=function(){r.$().prop("disabled",!0),r.publish("isEnabled",!1)},r.enable=function(){r.$().prop("disabled",!1),r.publish("isEnabled",!0)},i.equalTo=function(t,e){return t===e},i.publishChange=function(t,e){var n=r.get();i.equalTo(n,o)||r.publish("change",{e:t,domElement:e}),o=n},r}function f(t,e){var n=a(t,e);return n.get=function(){return n.$().val()},n.set=function(t){n.$().val(t)},n.clear=function(){n.set("")},e.buildSetter=function(e){return function(t){e.call(n,t)}},n}function d(t,e){t=b(t)?t:[t],e=b(e)?e:[e];var n=!0;return t.length!==e.length?n=!1:w(t,function(t){!function(t,e){return-1!==c(t,e)}(e,t)&&(n=!1)}),n}function g(t){var e={},n=f(t,e);return n.getType=function(){return"button"},n.$().on("change",function(t){e.publishChange(t,this)}),n}function v(t){var e={},n=f(t,e);return n.getType=function(){return"checkbox"},n.get=function(){var t=[];return n.$().filter(":checked").each(function(){t.push(s(this).val())}),t},n.set=function(t){t=b(t)?t:[t],n.$().each(function(){s(this).prop("checked",!1)}),w(t,function(t){n.$().filter('[value="'+t+'"]').prop("checked",!0)})},e.equalTo=d,n.$().change(function(t){e.publishChange(t,this)}),n}function E(t){var e=l(t);return e.getType=function(){return"email"},e}function D(t){var e={},n=a(t,e);return n.getType=function(){return"file"},n.get=function(){return x(n.$().val().split("\\"))},n.clear=function(){this.$().each(function(){s(this).wrap("<form>").closest("form").get(0).reset(),s(this).unwrap()})},n.$().change(function(t){e.publishChange(t,this)}),n}function O(t){var e={},n=f(t,e);return n.getType=function(){return"hidden"},n.$().change(function(t){e.publishChange(t,this)}),n}function S(t){var e={},i=a(t,e);return i.getType=function(){return"file[multiple]"},i.get=function(){var t,e=i.$().get(0).files||[],n=[];for(t=0;t<(e.length||0);t+=1)n.push(e[t].name);return n},i.clear=function(){this.$().each(function(){s(this).wrap("<form>").closest("form").get(0).reset(),s(this).unwrap()})},i.$().change(function(t){e.publishChange(t,this)}),i}function k(t){var e={},n=f(t,e);return n.getType=function(){return"select[multiple]"},n.get=function(){return n.$().val()||[]},n.set=function(t){n.$().val(""===t?[]:b(t)?t:[t])},e.equalTo=d,n.$().change(function(t){e.publishChange(t,this)}),n}function I(t){var e=l(t);return e.getType=function(){return"password"},e}function R(t){var e={},n=f(t,e);return n.getType=function(){return"radio"},n.get=function(){return n.$().filter(":checked").val()||null},n.set=function(t){t?n.$().filter('[value="'+t+'"]').prop("checked",!0):n.$().each(function(){s(this).prop("checked",!1)})},n.$().change(function(t){e.publishChange(t,this)}),n}function A(t){var e={},n=f(t,e);return n.getType=function(){return"range"},n.$().change(function(t){e.publishChange(t,this)}),n}function P(t){var e={},n=f(t,e);return n.getType=function(){return"select"},n.$().change(function(t){e.publishChange(t,this)}),n}function M(t){var e={},n=f(t,e);return n.getType=function(){return"textarea"},n.$().on("change keyup keydown",function(t){e.publishChange(t,this)}),n}function N(t){var e=l(t);return e.getType=function(){return"url"},e}function L(t){function e(e,t){(u(t)?t:r.find(t)).each(function(){var t=s(this).attr("name");o[t]=a[e]({$:s(this)})})}function n(e,t){var n=[],i=u(t)?t:r.find(t);u(t)?o[i.attr("name")]=a[e]({$:i}):(i.each(function(){-1===c(n,s(this).attr("name"))&&n.push(s(this).attr("name"))}),w(n,function(t){o[t]=a[e]({$:r.find('input[name="'+t+'"]')})}))}var o={},r=t.$,a=t.constructorOverride||{button:g,text:l,url:N,email:E,password:I,range:A,textarea:M,select:P,"select[multiple]":k,radio:R,checkbox:v,file:D,"file[multiple]":S,hidden:O};return r.is("input, select, textarea")?r.is('input[type="button"], button, input[type="submit"]')?e("button",r):r.is("textarea")?e("textarea",r):r.is('input[type="text"]')||r.is("input")&&!r.attr("type")?e("text",r):r.is('input[type="password"]')?e("password",r):r.is('input[type="email"]')?e("email",r):r.is('input[type="url"]')?e("url",r):r.is('input[type="range"]')?e("range",r):r.is("select")?r.is("[multiple]")?e("select[multiple]",r):e("select",r):r.is('input[type="file"]')?r.is("[multiple]")?e("file[multiple]",r):e("file",r):r.is('input[type="hidden"]')?e("hidden",r):r.is('input[type="radio"]')?n("radio",r):r.is('input[type="checkbox"]')?n("checkbox",r):e("text",r):(e("button",'input[type="button"], button, input[type="submit"]'),e("text",'input[type="text"]'),e("password",'input[type="password"]'),e("email",'input[type="email"]'),e("url",'input[type="url"]'),e("range",'input[type="range"]'),e("textarea","textarea"),e("select","select:not([multiple])"),e("select[multiple]","select[multiple]"),e("file",'input[type="file"]:not([multiple])'),e("file[multiple]",'input[type="file"][multiple]'),e("hidden",'input[type="hidden"]'),n("radio",'input[type="radio"]'),n("checkbox",'input[type="checkbox"]')),o}!function(){function e(i){function o(t){t.parentElement.removeChild(t)}function r(t,e,n){n<t.children.length?t.insertBefore(e,t.children[n]):t.appendChild(e)}function n(t,e){return t.map(function(t){return t.elm}).indexOf(e)}function a(t,e){this.$emit(t.toLowerCase(),e)}var s=["Start","Add","Remove","Update","End"],l=["Choose","Sort","Filter","Clone"],u=["Move"].concat(s,l).map(function(t){return"on"+t}),c=null;return{props:{options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},clone:{type:Function,default:function(t){return t}},element:{type:String,default:"div"},move:{type:Function,default:null}},data:function(){return{transitionMode:!1}},render:function(t){if(this.$slots.default&&1===this.$slots.default.length){var e=this.$slots.default[0];e.componentOptions&&"transition-group"===e.componentOptions.tag&&(this.transitionMode=!0)}return t(this.element,null,this.$slots.default)},mounted:function(){var e=this,n={};s.forEach(function(t){n["on"+t]=function(e){var n=this;return function(t){null!==n.realList&&n["onDrag"+e](t),a.call(n,e,t)}}.call(e,t)}),l.forEach(function(t){n["on"+t]=a.bind(e,t)});var t=h({},this.options,n,{onMove:function(t){return e.onDragMove(t)}});this._sortable=new i(this.rootContainer,t),this.computeIndexes()},beforeDestroy:function(){this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},isCloning:function(){return!!this.options&&!!this.options.group&&"clone"===this.options.group.pull},realList:function(){return this.list?this.list:this.value}},watch:{options:function(t){for(var e in t)-1==u.indexOf(e)&&this._sortable.option(e,t[e])},realList:function(){this.computeIndexes()}},methods:{getChildrenNodes:function(){var t=this.$slots.default;return this.transitionMode?t[0].child.$slots.default:t},computeIndexes:function(){var t=this;this.$nextTick(function(){t.visibleIndexes=function(e,t){return e?Array.prototype.map.call(t,function(t){return n(e,t)}):[]}(t.getChildrenNodes(),t.rootContainer.children)})},getUnderlyingVm:function(t){var e=n(this.getChildrenNodes(),t);return{index:e,element:this.realList[e]}},getUnderlyingPotencialDraggableComponent:function(t){var e=t.__vue__;return e&&e.$options&&"transition-group"===e.$options._componentTag?e.$parent:e},emitChanges:function(t){var e=this;this.$nextTick(function(){e.$emit("change",t)})},alterList:function(t){if(this.list)t(this.list);else{var e=[].concat(p(this.value));t(e),this.$emit("input",e)}},spliceList:function(){function t(t){return t.splice.apply(t,e)}var e=arguments;this.alterList(t)},updatePosition:function(e,n){function t(t){return t.splice(n,0,t.splice(e,1)[0])}this.alterList(t)},getRelatedContextFromMoveEvent:function(t){var e=t.to,n=t.related,i=this.getUnderlyingPotencialDraggableComponent(e);if(!i)return{component:i};var o=i.realList,r={list:o,component:i};if(e!==n&&o&&i.getUnderlyingVm){var a=i.getUnderlyingVm(n);return h(a,r)}return r},getVmIndex:function(t){var e=this.visibleIndexes,n=e.length;return n-1<t?n:e[t]},onDragStart:function(t){this.context=this.getUnderlyingVm(t.item),t.item._underlying_vm_=this.clone(this.context.element),c=t.item},onDragAdd:function(t){var e=t.item._underlying_vm_;if(void 0!==e){o(t.item);var n=this.getVmIndex(t.newIndex);this.spliceList(n,0,e),this.computeIndexes();var i={element:e,newIndex:n};this.emitChanges({added:i})}},onDragRemove:function(t){if(r(this.rootContainer,t.item,t.oldIndex),this.isCloning)o(t.clone);else{var e=this.context.index;this.spliceList(e,1);var n={element:this.context.element,oldIndex:e};this.emitChanges({removed:n})}},onDragUpdate:function(t){o(t.item),r(t.from,t.item,t.oldIndex);var e=this.context.index,n=this.getVmIndex(t.newIndex);this.updatePosition(e,n);var i={element:this.context.element,oldIndex:e,newIndex:n};this.emitChanges({moved:i})},computeFutureIndex:function(t,e){if(!t.element)return 0;var n=[].concat(p(e.to.children)),i=n.indexOf(e.related),o=t.component.getVmIndex(i);return-1!=n.indexOf(c)?o:o+1},onDragMove:function(t){var e=this.move;if(!e||!this.realList)return!0;var n=this.getRelatedContextFromMoveEvent(t),i=this.context,o=this.computeFutureIndex(n,t);return h(i,{futureIndex:o}),h(t,{relatedContext:n,draggedContext:i}),e(t)},onDragEnd:function(t){this.computeIndexes(),c=null}}}}if("object"==("undefined"==typeof exports?"undefined":ot(exports))){var t=require("sortablejs");module.exports=e(t)}else if("function"==typeof define&&define.amd)define(["sortablejs"],function(t){return e(t)});else if(window&&window.Vue&&window.Sortable){var n=e(window.Sortable);Vue.component("draggable",n)}}(),m=jQuery,s=jQuery,l=function(t){var e={},n=f(t,e);return n.getType=function(){return"text"},n.$().on("change keyup keydown",function(t){e.publishChange(t,this)}),n},s.fn.inputVal=function(t){var e=s(this),n=L({$:e});return e.is("input, textarea, select")?void 0===t?n[e.attr("name")].get():(n[e.attr("name")].set(t),e):void 0===t?r(n,"get"):(w(t,function(t,e){n[e].set(t)}),e)},s.fn.inputOnChange=function(e){var t=s(this),n=L({$:t});return w(n,function(t){t.subscribe("change",function(t){e.call(t.domElement,t.e)})}),t},s.fn.inputDisable=function(){var t=s(this);return r(L({$:t}),"disable"),t},s.fn.inputEnable=function(){var t=s(this);return r(L({$:t}),"enable"),t},s.fn.inputClear=function(){var t=s(this);return r(L({$:t}),"clear"),t},m.fn.repeaterVal=function(){var t,i;return function n(t){if(1===t.length&&(0===t[0].key.length||1===t[0].key.length&&!t[0].key[0]))return t[0].val;w(t,function(t){t.head=t.key.shift()});var i,e,o=(e={},w(t,function(t){e[t.head]||(e[t.head]=[]),e[t.head].push(t)}),e);return/^[0-9]+$/.test(t[0].head)?(i=[],w(o,function(t){i.push(n(t))})):(i={},w(o,function(t,e){i[e]=n(t)})),i}((t=m(this).inputVal(),i=[],w(t,function(t,e){var n=[];"undefined"!==e&&(n.push(e.match(/^[^\[]*/)[0]),n=n.concat($(e.match(/\[[^\]]*\]/g),function(t){return t.replace(/[\[\]]/g,"")})),i.push({val:t,key:n}))}),i))},m.fn.repeater=function(g){var v;return g=g||{},m(this).each(function(){function l(t,e){return t.filter(function(){return!e||0===m(this).closest(function(t,e){return $(t,function(t){return t[e]})}(e,"selector").join(",")).length})}function n(){return l(o.find("[data-repeater-item]"),g.repeaters)}var t=m(this),i=g.show||function(){m(this).show()},e=g.hide||function(t){t()},o=t.find("[data-repeater-list]").first(),r=o.find("[data-repeater-item]").first().clone().hide(),a=l(l(m(this).find("[data-repeater-item]"),g.repeaters).first().find("[data-repeater-delete]"),g.repeaters);function s(){var t=o.data("repeater-list");return g.$parent?g.$parent.data("item-name")+"["+t+"]":t}function u(t){g.repeaters&&t.each(function(){var e=m(this);w(g.repeaters,function(t){e.find(t.selector).repeater(C(t,{$parent:e}))})})}function c(t,e,n){t&&w(t,function(t){n.call(e.find(t.selector)[0],t)})}function h(t,a,s){t.each(function(o){var r=m(this);r.data("item-name",a+"["+o+"]"),l(r.find("[name]"),s).each(function(){var t=m(this),e=t.attr("name").match(/\[[^\]]+\]/g),n=e?x(e).replace(/\[|\]/g,""):t.attr("name"),i=a+"["+o+"]["+n+"]"+(t.is(":checkbox")||t.attr("multiple")?"[]":"");t.attr("name",i),c(s,r,function(t){var e=m(this);h(l(e.find("[data-repeater-item]"),t.repeaters||[]),a+"["+o+"]["+e.find("[data-repeater-list]").first().data("repeater-list")+"]",t.repeaters)})})}),o.find("input[name][checked]").removeAttr("checked").prop("checked",!0)}function p(t){var e=r.clone();f(e,t),g.repeaters&&u(e),i.call(e.get(0))}g.isFirstItemUndeletable&&a&&a.remove(),h(n(),s(),g.repeaters),u(n()),g.initEmpty&&n().remove(),g.ready&&g.ready(function(){h(n(),s(),g.repeaters)});var f=function(t,e){o.append(t),h(n(),s(),g.repeaters),t.find("[name]").each(function(){m(this).inputClear()}),d(t,e||g.defaultValues,g.repeaters)};function d(t,e,n){if(e||g.defaultValues){var i={};l(t.find("[name]"),n).each(function(){var t=m(this).attr("name").match(/\[([^\]]*)(\]|\]\[\])$/)[1];i[t]=m(this).attr("name")}),t.inputVal($(function(t,i){var o;return b(t)?(o=[],w(t,function(t,e,n){i(t,e,n)&&o.push(t)})):(o={},w(t,function(t,e,n){i(t,e,n)&&(o[e]=t)})),o}(e||g.defaultValues,function(t,e){return i[e]}),y,function(t){return i[t]}))}c(n,t,function(i){var o=m(this);l(o.find("[data-repeater-item]"),i.repeaters).each(function(){var t=o.find("[data-repeater-list]").data("repeater-list");if(e&&e[t]){var n=m(this).clone();o.find("[data-repeater-item]").remove(),w(e[t],function(t){var e=n.clone();d(e,t,i.repeaters||[]),o.find("[data-repeater-list]").append(e)})}else d(m(this),i.defaultValues,i.repeaters||[])})})}v=function(t){n().remove(),w(t,p)},l(t.find("[data-repeater-create]"),g.repeaters).click(function(){p()}),o.on("click","[data-repeater-delete]",function(){var t=m(this).closest("[data-repeater-item]").get(0);e.call(t,function(){m(t).remove(),h(n(),s(),g.repeaters)})})}),this.setList=v,this}});

//# sourceMappingURL=vendor.js.map
